<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>åœ‹ä¸­è‹±æ–‡é€šé—œå‚³èªªï¼šå…¨èª²ç¶±çµ‚æ¥µç‰ˆ</title>
    <style>
        :root {
            --primary: #6366f1;
            --secondary: #4f46e5;
            --accent: #f59e0b;
            --bg: #f0fdf4;
            --card-bg: #ffffff;
            --text: #1f2937;
            --correct: #10b981;
            --wrong: #ef4444;
        }

        body {
            font-family: 'Microsoft JhengHei', 'Segoe UI', sans-serif;
            background-color: var(--bg);
            color: var(--text);
            margin: 0;
            padding: 20px;
            min-height: 100vh;
        }

        .container {
            max-width: 900px; /*ç¨å¾®åŠ å¯¬ä»¥å®¹ç´æ›´å¤šå¡ç‰‡*/
            margin: 0 auto;
        }

        /* --- Header --- */
        header {
            text-align: center;
            margin-bottom: 30px;
        }
        h1 {
            color: var(--secondary);
            font-size: 1.8rem;
            margin-bottom: 5px;
        }
        .subtitle {
            color: #6b7280;
            font-size: 0.95rem;
        }

        /* --- Menu Grid System --- */
        .menu-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(260px, 1fr));
            gap: 20px;
        }

        .topic-card {
            background: var(--card-bg);
            border-radius: 16px;
            padding: 20px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.05);
            cursor: pointer;
            transition: transform 0.2s, box-shadow 0.2s;
            border: 2px solid transparent;
            display: flex;
            flex-direction: column;
            justify-content: space-between;
            position: relative;
            overflow: hidden;
        }

        .topic-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 15px rgba(0,0,0,0.1);
            border-color: var(--primary);
        }

        .topic-icon {
            font-size: 2rem;
            margin-bottom: 10px;
        }
        .topic-title {
            font-weight: bold;
            font-size: 1.15rem;
            margin-bottom: 5px;
            color: var(--text);
        }
        .topic-desc {
            font-size: 0.85rem;
            color: #6b7280;
            line-height: 1.4;
            margin-bottom: 10px;
        }
        .topic-tag {
            display: inline-block;
            font-size: 0.75rem;
            padding: 4px 8px;
            border-radius: 12px;
            background: #e0e7ff;
            color: var(--secondary);
            font-weight: bold;
            width: fit-content;
        }
        /* åœ‹ä¸‰æ¨™ç±¤ç‰¹åˆ¥é¡è‰² */
        .tag-g3 { background: #fee2e2; color: #b91c1c; }
        .tag-g2 { background: #fef3c7; color: #b45309; }

        /* --- Game Interface --- */
        #game-interface {
            display: none;
            background: var(--card-bg);
            border-radius: 20px;
            box-shadow: 0 10px 25px rgba(0,0,0,0.1);
            overflow: hidden;
            max-width: 650px;
            margin: 0 auto;
        }

        .game-header {
            background: var(--primary);
            color: white;
            padding: 15px 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .back-btn {
            background: rgba(255,255,255,0.2);
            border: none;
            color: white;
            padding: 5px 12px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 0.9rem;
        }

        .concept-section {
            padding: 20px;
            background: #fdf2f8;
            border-bottom: 2px solid #fce7f3;
        }
        .concept-title { font-weight: bold; color: #db2777; margin-bottom: 8px; }
        .concept-content { font-size: 0.95rem; line-height: 1.6; }

        .quiz-section {
            padding: 30px 25px;
        }

        .progress-info {
            display: flex;
            justify-content: space-between;
            margin-bottom: 20px;
            font-size: 0.9rem;
            color: #6b7280;
        }

        .question-box {
            font-size: 1.35rem;
            font-weight: bold;
            text-align: center;
            margin-bottom: 30px;
            min-height: 60px;
            display: flex;
            align-items: center;
            justify-content: center;
            line-height: 1.4;
        }

        .options-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
        }

        .option-btn {
            background: white;
            border: 2px solid #e5e7eb;
            padding: 15px;
            border-radius: 12px;
            font-size: 1.05rem;
            cursor: pointer;
            transition: 0.2s;
            color: var(--text);
            display: flex;
            align-items: center;
            justify-content: center;
        }
        .option-btn:hover:not(:disabled) {
            background: #f9fafb;
            border-color: #d1d5db;
        }

        .feedback-box {
            margin-top: 20px;
            padding: 15px;
            border-radius: 10px;
            text-align: center;
            font-weight: bold;
            display: none;
            line-height: 1.5;
        }
        .feedback-correct { background: #d1fae5; color: #065f46; }
        .feedback-wrong { background: #fee2e2; color: #991b1b; }

        .next-btn {
            display: none;
            width: 100%;
            margin-top: 15px;
            padding: 15px;
            background: var(--secondary);
            color: white;
            border: none;
            border-radius: 12px;
            font-size: 1.1rem;
            cursor: pointer;
            font-weight: bold;
        }

        /* --- Result View --- */
        #result-view {
            display: none;
            text-align: center;
            padding: 40px;
            background: var(--card-bg);
            border-radius: 20px;
            box-shadow: 0 10px 25px rgba(0,0,0,0.1);
        }
        .stars { font-size: 3rem; color: #d1d5db; margin: 20px 0; }
        .stars span.gold { color: var(--accent); text-shadow: 0 0 15px rgba(245, 158, 11, 0.6); }
        .score-big { font-size: 4rem; font-weight: 900; color: var(--secondary); }
        
        .highlight-keyword {
            color: #d946ef;
            font-weight: bold;
            background: #fae8ff;
            padding: 2px 6px;
            border-radius: 4px;
        }

    </style>
</head>
<body>

<div class="container">
    <header id="main-header">
        <h1>âš”ï¸ åœ‹ä¸­è‹±æ–‡é€šé—œå‚³èªªï¼šå…¨æ”»ç•¥</h1>
        <div class="subtitle">åŒ…å«åè©ã€æ™‚æ…‹ã€åŠ©å‹•è©ã€è¢«å‹•èªæ…‹èˆ‡ä¸‰å¤§å­å¥</div>
    </header>

    <div id="menu-view" class="menu-grid">
        </div>

    <div id="game-interface">
        <div class="game-header">
            <button class="back-btn" onclick="showMenu()">â® å›ç›®éŒ„</button>
            <span id="level-title-display">Level Title</span>
            <span>â˜… <span id="current-score">0</span></span>
        </div>
        
        <div class="concept-section" id="concept-display"></div>

        <div class="quiz-section">
            <div class="progress-info">
                <span>æŒ‘æˆ°é€²åº¦</span>
                <span id="progress-text">1 / 5</span>
            </div>
            
            <div class="question-box" id="question-text">Loading...</div>

            <div class="options-grid" id="options-area"></div>

            <div class="feedback-box" id="feedback-area"></div>
            <button class="next-btn" id="next-btn" onclick="nextQuestion()">ä¸‹ä¸€é¡Œ â”</button>
        </div>
    </div>

    <div id="result-view">
        <h2>ğŸ‰ é—œå¡å®Œæˆï¼</h2>
        <div class="stars" id="result-stars">
            <span>â˜…</span><span>â˜…</span><span>â˜…</span>
        </div>
        <div>æœ¬æ¬¡å¾—åˆ†</div>
        <div class="score-big" id="final-score">0</div>
        <p id="result-comment" style="color:#666; margin-bottom: 30px;">è©•èª...</p>
        <button class="option-btn" style="background:var(--secondary); color:white; border:none;" onclick="showMenu()">å›åˆ°åœ°åœ–</button>
    </div>
</div>

<script>
    // --- Data: å®Œæ•´åœ‹ä¸­æ ¸å¿ƒæ–‡æ³•è³‡æ–™åº« ---
    const grammarData = [
        // --- åœ‹ä¸€ (åŸºç¤) ---
        {
            title: "L1. Be å‹•è©ç‹è€…",
            desc: "am, is, are çš„è®ŠåŒ–è¦å‰‡ã€‚",
            tag: "åœ‹ä¸€åŸºç¤",
            tagClass: "tag-g1",
            concept: "å£è¨£ï¼šI é… amï¼ŒYou é… areï¼Œå–®æ•¸ isï¼Œè¤‡æ•¸ areã€‚",
            questions: [
                { q: "I ___ a student.", options: ["am", "is", "are"], ans: 0, explain: "I å°ˆç”¨ amã€‚" },
                { q: "Tom and I ___ brothers.", options: ["am", "is", "are"], ans: 2, explain: "Tom and I = We (è¤‡æ•¸)ï¼Œç”¨ areã€‚" },
                { q: "My father ___ busy.", options: ["am", "is", "are"], ans: 1, explain: "Father (ä»–) æ˜¯å–®æ•¸ï¼Œç”¨ isã€‚" },
                { q: "The cats ___ cute.", options: ["is", "am", "are"], ans: 2, explain: "Cats æœ‰ s æ˜¯è¤‡æ•¸ï¼Œç”¨ areã€‚" }
            ]
        },
        {
            title: "L2. ä»£åè©èˆ‡æ‰€æœ‰æ ¼",
            desc: "ä¸»æ ¼ã€å—æ ¼ã€æ‰€æœ‰æ ¼å¤§äº‚é¬¥ã€‚",
            tag: "åœ‹ä¸€é‡é»",
            tagClass: "tag-g1",
            concept: "ä¸»æ ¼æ”¾å¥é¦–(I)ï¼Œå—æ ¼æ”¾å‹•è©å¾Œ(me)ï¼Œæ‰€æœ‰æ ¼å¾Œé¢æ¥åè©(my book)ã€‚",
            questions: [
                { q: "___ likes apples.", options: ["He", "Him", "His"], ans: 0, explain: "å¥é¦–ç¼ºä¸»è©ï¼Œç”¨ä¸»æ ¼ Heã€‚" },
                { q: "Don't look at ___.", options: ["I", "me", "my"], ans: 1, explain: "at æ˜¯ä»‹ç³»è©ï¼Œå¾Œé¢æ¥å—æ ¼ meã€‚" },
                { q: "This is ___ pen.", options: ["she", "her", "hers"], ans: 1, explain: "pen æ˜¯åè©ï¼Œå‰é¢ç”¨æ‰€æœ‰æ ¼ herã€‚" },
                { q: "Is that bike ___?", options: ["you", "your", "yours"], ans: 2, explain: "å¥å°¾æ²’æœ‰åè©ï¼Œç”¨æ‰€æœ‰æ ¼ä»£åè© yours (ä½ çš„æ±è¥¿)ã€‚" }
            ]
        },
        {
            title: "L3. ä¸€èˆ¬å‹•è©èˆ‡åŠ©å‹•è©",
            desc: "Do/Does çš„ç”¨æ³•èˆ‡ç¬¬ä¸‰äººç¨±å–®æ•¸ã€‚",
            tag: "åœ‹ä¸€æ ¸å¿ƒ",
            tagClass: "tag-g1",
            concept: "ç–‘å•å¦å®šæ‰¾ Do/Doesã€‚ä¸‰å–®(He/She/It)ç”¨ Doesï¼Œå‹•è©è¨˜å¾—æ‰“å›åŸå½¢ï¼",
            questions: [
                { q: "___ you like cats?", options: ["Do", "Does", "Are"], ans: 0, explain: "You æ­é… Doã€‚" },
                { q: "She ___ not eat beef.", options: ["do", "does", "is"], ans: 1, explain: "She æ˜¯ä¸‰å–®ï¼Œå¦å®šç”¨ does notã€‚" },
                { q: "Does he ___ to school?", options: ["go", "goes", "going"], ans: 0, explain: "Does å‡ºç¾ï¼Œå‹•è©è®ŠåŸå½¢ goã€‚" },
                { q: "My mom ___ pizza.", options: ["like", "likes", "liking"], ans: 1, explain: "Mom (ä¸‰å–®) è‚¯å®šå¥å‹•è©åŠ  sã€‚" }
            ]
        },
        {
            title: "L4. ç¾åœ¨é€²è¡Œå¼",
            desc: "Be + V-ing è¡¨ç¤ºæ­£åœ¨ç™¼ç”Ÿçš„å‹•ä½œã€‚",
            tag: "åœ‹ä¸€å‹•è©",
            tagClass: "tag-g1",
            concept: "æ­£åœ¨åš = Beå‹•è© + V-ingã€‚ç¼ºä¸€ä¸å¯ï¼",
            questions: [
                { q: "Look! He is ___.", options: ["run", "running", "runs"], ans: 1, explain: "is å¾Œé¢æ¥ ing (å­—å°¾å–®ä¸€å­éŸ³é‡è¤‡ n)ã€‚" },
                { q: "Are they ___ TV?", options: ["watch", "watching", "watches"], ans: 1, explain: "Are å¾Œé¢æ¥ V-ingã€‚" },
                { q: "What ___ you doing?", options: ["do", "are", "can"], ans: 1, explain: "doing æš—ç¤ºé€²è¡Œå¼ï¼Œæ­é… areã€‚" }
            ]
        },
        {
            title: "L5. å­˜åœ¨å¥èˆ‡æ•¸é‡",
            desc: "There is/are èˆ‡ How many/muchã€‚",
            tag: "åœ‹ä¸€é€²éš",
            tagClass: "tag-g1",
            concept: "There is + å–®æ•¸/ä¸å¯æ•¸ã€‚There are + è¤‡æ•¸ã€‚Manyæ¥å¯æ•¸ï¼ŒMuchæ¥ä¸å¯æ•¸ã€‚",
            questions: [
                { q: "There ___ a book on the desk.", options: ["is", "are", "have"], ans: 0, explain: "a book å–®æ•¸ç”¨ isã€‚" },
                { q: "There ___ many people here.", options: ["is", "are", "has"], ans: 1, explain: "people æ˜¯è¤‡æ•¸ï¼Œç”¨ areã€‚" },
                { q: "How ___ water do you need?", options: ["many", "much", "long"], ans: 1, explain: "Water ä¸å¯æ•¸ï¼Œç”¨ muchã€‚" },
                { q: "How ___ apples are there?", options: ["many", "much", "old"], ans: 0, explain: "Apples å¯æ•¸ï¼Œç”¨ manyã€‚" }
            ]
        },
        // --- åœ‹äºŒ (è®ŠåŒ–) ---
        {
            title: "L6. éå»å¼ (Beå‹•è©)",
            desc: "Was èˆ‡ Were çš„æ™‚å…‰æ©Ÿã€‚",
            tag: "åœ‹äºŒåŸºç¤",
            tagClass: "tag-g2",
            concept: "am/is è®Š wasï¼Œare è®Š wereã€‚é—œéµå­—ï¼šYesterday, Last nightã€‚",
            questions: [
                { q: "I ___ sick yesterday.", options: ["am", "was", "were"], ans: 1, explain: "Yesterday éå»å¼ï¼ŒI ç”¨ wasã€‚" },
                { q: "They ___ at the zoo last week.", options: ["are", "was", "were"], ans: 2, explain: "Last week éå»å¼ï¼ŒThey ç”¨ wereã€‚" },
                { q: "___ she happy then?", options: ["Was", "Were", "Did"], ans: 0, explain: "She å–®æ•¸ç”¨ Was é–‹é ­ã€‚" }
            ]
        },
        {
            title: "L7. éå»å¼ (ä¸€èˆ¬å‹•è©)",
            desc: "Did èˆ‡å‹•è©çš„éå»è®ŠåŒ–ã€‚",
            tag: "åœ‹äºŒæ ¸å¿ƒ",
            tagClass: "tag-g2",
            concept: "ç–‘å•å¦å®šæ‰¾ Didã€‚Did å‡ºç¾å‹•è©å›åŸå½¢ã€‚æ³¨æ„ä¸è¦å‰‡è®ŠåŒ– (goâ†’went)ã€‚",
            questions: [
                { q: "He ___ basketball yesterday.", options: ["play", "played", "plays"], ans: 1, explain: "éå»è‚¯å®šå¥åŠ  edã€‚" },
                { q: "We ___ to Taipei last year.", options: ["go", "went", "goes"], ans: 1, explain: "Go çš„éå»å¼æ˜¯ Wentã€‚" },
                { q: "Did you ___ him?", options: ["see", "saw", "seeing"], ans: 0, explain: "Did å‡ºç¾ï¼Œå‹•è©ç”¨åŸå½¢ seeã€‚" },
                { q: "I didn't ___ dinner.", options: ["eat", "ate", "eaten"], ans: 0, explain: "didn't å‡ºç¾ï¼Œå‹•è©ç”¨åŸå½¢ eatã€‚" }
            ]
        },
        {
            title: "L8. æœªä¾†å¼",
            desc: "Will èˆ‡ Be going toã€‚",
            tag: "åœ‹äºŒæ™‚æ…‹",
            tagClass: "tag-g2",
            concept: "will + åŸå½¢å‹•è© = be going to + åŸå½¢å‹•è©ã€‚",
            questions: [
                { q: "I ___ call you later.", options: ["will", "am", "going"], ans: 0, explain: "will å¾Œæ¥åŸå½¢ï¼Œè¡¨ç¤ºå°‡è¦ã€‚" },
                { q: "He is ___ to buy a car.", options: ["go", "going", "will"], ans: 1, explain: "is going to ç‰‡èªã€‚" },
                { q: "They will ___ busy tomorrow.", options: ["be", "are", "is"], ans: 0, explain: "will å¾Œé¢ä¸€å®šè¦åŸå½¢ï¼Œå½¢å®¹è©å‰è¦è£œ beã€‚" }
            ]
        },
        {
            title: "L9. å½¢å®¹è©æ¯”è¼ƒç´šèˆ‡æœ€é«˜ç´š",
            desc: "er/more èˆ‡ the est/mostã€‚",
            tag: "åœ‹äºŒé€²éš",
            tagClass: "tag-g2",
            concept: "å…©è€…æ¯”è¼ƒç”¨ er/more + thanã€‚ä¸‰è€…ä»¥ä¸Šæœ€é«˜ç´šç”¨ the + est/mostã€‚",
            questions: [
                { q: "Wait for me! You are ___ than me.", options: ["fast", "faster", "fastest"], ans: 1, explain: "than å‰é¢ç”¨æ¯”è¼ƒç´š fasterã€‚" },
                { q: "English is ___ than math.", options: ["easy", "easier", "more easy"], ans: 1, explain: "easy å» y æ”¹ ierã€‚" },
                { q: "Who is the ___ student in class?", options: ["tall", "taller", "tallest"], ans: 2, explain: "in class ç¯„åœå…§æœ€...ï¼Œæœ‰ the ç”¨æœ€é«˜ç´šã€‚" },
                { q: "The movie is the most ___.", options: ["good", "better", "popular"], ans: 2, explain: "most æ­é…é•·éŸ³ç¯€å½¢å®¹è© popularã€‚" }
            ]
        },
        {
            title: "L10. å‹•åè© vs ä¸å®šè©",
            desc: "Like V-ing é‚„æ˜¯ Want to Vï¼Ÿ",
            tag: "åœ‹äºŒé‡é»",
            tagClass: "tag-g2",
            concept: "Enjoy/Practice/Finish + V-ingã€‚<br>Want/Need/Plan + to Vã€‚<br>Like/Love/Start å…©è€…çš†å¯ã€‚",
            questions: [
                { q: "I enjoy ___ English.", options: ["learn", "learning", "to learn"], ans: 1, explain: "Enjoy å¾Œé¢å¿…æ¥ V-ingã€‚" },
                { q: "He wants ___ a doctor.", options: ["be", "being", "to be"], ans: 2, explain: "Want å¾Œé¢å¿…æ¥ to Vã€‚" },
                { q: "She practices ___ the piano.", options: ["play", "playing", "to play"], ans: 1, explain: "Practice å¾Œé¢å¿…æ¥ V-ingã€‚" },
                { q: "They decided ___ home.", options: ["go", "going", "to go"], ans: 2, explain: "Decide (æ±ºå®š) å¾Œé¢æ¥ to Vã€‚" }
            ]
        },
        // --- åœ‹ä¸‰ (é«˜éš) ---
        {
            title: "L11. åŠ©å‹•è©å¤§å…¨",
            desc: "Can, Must, Should, Have to ç”¨æ³•ã€‚",
            tag: "åœ‹ä¸‰å¿…è€ƒ",
            tagClass: "tag-g3",
            concept: "æ‰€æœ‰åŠ©å‹•è©(Can/Must/Should)å¾Œæ¥åŸå½¢ã€‚<br>Must = Have to (å¿…é ˆ)ã€‚",
            questions: [
                { q: "You ___ study hard.", options: ["should", "should to", "are"], ans: 0, explain: "Should (æ‡‰è©²) ç›´æ¥åŠ åŸå½¢ã€‚" },
                { q: "He ___ to go now.", options: ["must", "has", "should"], ans: 1, explain: "æœ‰ toï¼Œæ‰€ä»¥æ˜¯ç”¨ has to (å¿…é ˆ)ã€‚Must å¾Œä¸åŠ  toã€‚" },
                { q: "I ___ swim.", options: ["can", "am", "can to"], ans: 0, explain: "Can (æœƒ/èƒ½å¤ ) åŠ åŸå½¢ã€‚" }
            ]
        },
        {
            title: "L12. ç¾åœ¨å®Œæˆå¼",
            desc: "Have/Has + p.p. çš„ç¶“é©—èˆ‡æŒçºŒã€‚",
            tag: "åœ‹ä¸‰æ ¸å¿ƒ",
            tagClass: "tag-g3",
            concept: "å…¬å¼ï¼šHave/Has + p.p.<br>é—œéµå­—ï¼šSince(è‡ªå¾), For(æŒçºŒ), Just, Yet, Everã€‚",
            questions: [
                { q: "I ___ been to Japan twice.", options: ["am", "did", "have"], ans: 2, explain: "been æ˜¯ be çš„ p.p.ï¼Œæ­é… Have å½¢æˆå®Œæˆå¼ã€‚" },
                { q: "She has ___ lunch.", options: ["eat", "ate", "eaten"], ans: 2, explain: "Has å¾Œé¢æ¥ p.p. (eaten)ã€‚" },
                { q: "We have lived here ___ ten years.", options: ["since", "for", "in"], ans: 1, explain: "Ten years æ˜¯ä¸€æ®µæ™‚é–“ï¼Œç”¨ forã€‚" },
                { q: "He has studied ___ 2010.", options: ["since", "for", "ago"], ans: 0, explain: "2010 æ˜¯æ™‚é–“é»ï¼Œç”¨ since (è‡ªå¾)ã€‚" }
            ]
        },
        {
            title: "L13. è¢«å‹•èªæ…‹",
            desc: "ä¸»è©è¢«å‹•ä½œï¼šBe + p.p. (+ by)ã€‚",
            tag: "åœ‹ä¸‰é›£é»",
            tagClass: "tag-g3",
            concept: "å…¬å¼ï¼šBeå‹•è©(æ³¨æ„æ™‚æ…‹) + p.p.ã€‚<br>å£è¨£ï¼šä¸»å‹•è®Šè¢«å‹•ï¼Œä½ç½®äº¤å‰æ›ã€‚",
            questions: [
                { q: "The cake ___ eaten by him.", options: ["is", "has", "did"], ans: 0, explain: "è¢«åƒæ‰ = is eaten (Be + p.p.)ã€‚" },
                { q: "The book was ___ by Mark.", options: ["wrote", "write", "written"], ans: 2, explain: "Was å¾Œé¢æ¥ p.p. (written)ã€‚" },
                { q: "Homework must be ___.", options: ["do", "done", "did"], ans: 1, explain: "Must be å¾Œé¢æ¥ p.p. (done)ã€‚" }
            ]
        },
        {
            title: "L14. åè©å­å¥",
            desc: "I know that... / I don't know who...",
            tag: "åœ‹ä¸‰é€²éš",
            tagClass: "tag-g3",
            concept: "å­å¥ç•¶åè©ç”¨ã€‚æ³¨æ„ï¼šå­å¥å…§ä¸å†å€’è£ï¼<br>éŒ¯ï¼šI know who is he.<br>å°ï¼šI know who he is.",
            questions: [
                { q: "I think ___ he is a good man.", options: ["that", "what", "which"], ans: 0, explain: "think å¾Œé¢æ¥ that å­å¥ã€‚" },
                { q: "Do you know who ___?", options: ["is she", "she is", "does she"], ans: 1, explain: "åè©å­å¥ä¸å€’è£ï¼Œå…ˆä¸»è© she å†å‹•è© isã€‚" },
                { q: "I don't know where ___.", options: ["does he live", "he lives", "he live"], ans: 1, explain: "å­å¥å›å¾©ç›´è¿°å¥ï¼šhe livesã€‚" }
            ]
        },
        {
            title: "L15. é™„å’Œå¥èˆ‡é€£æ¥è©",
            desc: "So do I / Neither do I èˆ‡é€£æ¥è©ã€‚",
            tag: "åœ‹ä¸‰ç¸½çµ",
            tagClass: "tag-g3",
            concept: "è‚¯å®šé™„å’Œï¼šSo + åŠ©å‹•è© + ä¸»è©ã€‚<br>å¦å®šé™„å’Œï¼šNeither + åŠ©å‹•è© + ä¸»è©ã€‚",
            questions: [
                { q: "A: I like dogs. B: So ___ I.", options: ["do", "am", "can"], ans: 0, explain: "Like æ˜¯ç”± do åŠ©å‹•è©å¹«å¿™ï¼Œæ‰€ä»¥ç”¨ So do Iã€‚" },
                { q: "A: I am happy. B: So ___ I.", options: ["do", "am", "was"], ans: 1, explain: "å‰å¥æœ‰ amï¼Œé™„å’Œå°±ç”¨ amã€‚" },
                { q: "A: I can't fly. B: ___ can I.", options: ["So", "Neither", "Either"], ans: 1, explain: "å¦å®šå¥çš„é™„å’Œï¼ˆæˆ‘ä¹Ÿä¸è¡Œï¼‰ç”¨ Neitherã€‚" },
                { q: "Although it rained, ___ we went out.", options: ["but", "x", "so"], ans: 1, explain: "Although(é›–ç„¶) å’Œ But(ä½†æ˜¯) ä¸èƒ½é€£ç”¨ï¼é¸ xã€‚" }
            ]
        }
    ];

    // --- State Management ---
    let currentTopic = null;
    let currentQuestionIndex = 0;
    let score = 0;

    // --- DOM Elements ---
    const menuView = document.getElementById('menu-view');
    const gameInterface = document.getElementById('game-interface');
    const mainHeader = document.getElementById('main-header');
    const resultView = document.getElementById('result-view');
    
    // Game elements
    const conceptDisplay = document.getElementById('concept-display');
    const questionText = document.getElementById('question-text');
    const optionsArea = document.getElementById('options-area');
    const feedbackArea = document.getElementById('feedback-area');
    const nextBtn = document.getElementById('next-btn');
    const scoreDisplay = document.getElementById('current-score');
    const progressText = document.getElementById('progress-text');
    const levelTitleDisplay = document.getElementById('level-title-display');

    // --- Initialization ---
    function init() {
        renderMenu();
    }

    function renderMenu() {
        menuView.innerHTML = '';
        grammarData.forEach((topic, index) => {
            const card = document.createElement('div');
            card.className = 'topic-card';
            card.onclick = () => startGame(index);
            
            // Assign random icon
            const icons = ['ğŸ°', 'âš”ï¸', 'ğŸ›¡ï¸', 'ğŸ§™â€â™‚ï¸', 'ğŸ‰', 'ğŸ“œ', 'ğŸ¯', 'ğŸ’', 'ğŸº', 'ğŸ—ï¸'];
            const icon = icons[index % icons.length];
            const tagClass = topic.tagClass || '';

            card.innerHTML = `
                <div>
                    <div class="topic-icon">${icon}</div>
                    <div class="topic-title">${topic.title}</div>
                    <div class="topic-desc">${topic.desc}</div>
                </div>
                <div class="topic-tag ${tagClass}">${topic.tag}</div>
            `;
            menuView.appendChild(card);
        });
    }

    // --- Game Logic ---
    function startGame(index) {
        currentTopic = grammarData[index];
        currentQuestionIndex = 0;
        score = 0;
        
        menuView.style.display = 'none';
        mainHeader.style.display = 'none';
        resultView.style.display = 'none';
        gameInterface.style.display = 'block';

        levelTitleDisplay.textContent = currentTopic.title;
        // Concept åŠ ä¸Šæ¨™é¡Œæ¨£å¼
        conceptDisplay.innerHTML = `
            <div class="concept-title">ğŸ’¡ æ”»ç•¥ç§˜ç±</div>
            <div class="concept-content">${currentTopic.concept}</div>
        `;
        scoreDisplay.textContent = 0;

        loadQuestion();
    }

    function showMenu() {
        gameInterface.style.display = 'none';
        resultView.style.display = 'none';
        mainHeader.style.display = 'block';
        menuView.style.display = 'grid';
    }

    function loadQuestion() {
        const qData = currentTopic.questions[currentQuestionIndex];
        
        progressText.textContent = `${currentQuestionIndex + 1} / ${currentTopic.questions.length}`;
        questionText.textContent = qData.q;
        
        // Reset Inputs
        feedbackArea.style.display = 'none';
        feedbackArea.className = 'feedback-box';
        nextBtn.style.display = 'none';
        optionsArea.innerHTML = '';

        // Generate Options
        qData.options.forEach((opt, idx) => {
            const btn = document.createElement('button');
            btn.className = 'option-btn';
            btn.textContent = opt;
            btn.onclick = () => checkAnswer(idx);
            optionsArea.appendChild(btn);
        });
    }

    function checkAnswer(selectedIndex) {
        const qData = currentTopic.questions[currentQuestionIndex];
        const buttons = optionsArea.querySelectorAll('button');
        
        buttons.forEach(btn => btn.disabled = true);

        if(selectedIndex === qData.ans) {
            score++;
            scoreDisplay.textContent = score;
            buttons[selectedIndex].style.background = '#d1fae5';
            buttons[selectedIndex].style.borderColor = '#10b981';
            feedbackArea.textContent = "ğŸ‰ æ­£ç¢ºï¼ " + qData.explain;
            feedbackArea.classList.add('feedback-correct');
        } else {
            buttons[selectedIndex].style.background = '#fee2e2';
            buttons[selectedIndex].style.borderColor = '#ef4444';
            buttons[qData.ans].style.background = '#d1fae5';
            
            feedbackArea.textContent = "ğŸ’ª ç­”éŒ¯å›‰ï¼ " + qData.explain;
            feedbackArea.classList.add('feedback-wrong');
        }

        feedbackArea.style.display = 'block';
        nextBtn.style.display = 'block';
    }

    function nextQuestion() {
        if (currentQuestionIndex < currentTopic.questions.length - 1) {
            currentQuestionIndex++;
            loadQuestion();
        } else {
            showResult();
        }
    }

    function showResult() {
        gameInterface.style.display = 'none';
        resultView.style.display = 'block';

        const total = currentTopic.questions.length;
        const finalScoreVal = Math.round((score / total) * 100);
        document.getElementById('final-score').textContent = finalScoreVal;

        let starsHTML = '';
        let comment = '';
        if (score === total) {
            starsHTML = '<span class="gold">â˜…</span><span class="gold">â˜…</span><span class="gold">â˜…</span>';
            comment = "å®Œç¾é€šé—œï¼ä½ æ˜¯æ–‡æ³•å¤§å¸«ï¼ğŸ†";
        } else if (score >= total - 1) {
            starsHTML = '<span class="gold">â˜…</span><span class="gold">â˜…</span><span>â˜…</span>';
            comment = "å¤ªæ£’äº†ï¼è§€å¿µéå¸¸æ¸…æ¥šï¼ğŸ‘";
        } else {
            starsHTML = '<span class="gold">â˜…</span><span>â˜…</span><span>â˜…</span>';
            comment = "å†æ¥å†å²ï¼å¼„æ‡‚è§€å¿µå°±æ˜¯é€²æ­¥ï¼ğŸ’ª";
        }

        document.getElementById('result-stars').innerHTML = starsHTML;
        document.getElementById('result-comment').textContent = comment;
    }

    // Run
    init();

</script>

</body>
</html>
